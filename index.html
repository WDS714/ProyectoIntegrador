<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Sensor de Humedad para Invernaderos de Tomate 🍅</title>
  <link rel="stylesheet" href="/style.css">


</head>
<body>
  <header>
    <h1>Sensor de Humedad para Invernaderos de Tomate 🍅</h1>
  </header>

  <div class="info-section">
    <div class="card">
      <h2>¿Por qué monitorear la humedad del suelo?</h2>
      <p>
        Monitorear la humedad del suelo es esencial para evitar el estrés hídrico en los cultivos de tomate. Un suelo muy seco puede afectar negativamente el crecimiento, mientras que un exceso de agua favorece enfermedades fúngicas.
      </p>
    </div>
    <div class="card">
      <h2>Tomates en Invernaderos Colombianos</h2>
      <p>
        En Colombia, departamentos como Boyacá, Cundinamarca y Antioquia lideran la producción de tomate en invernadero. Este método permite controlar mejor variables como la humedad, la temperatura y la luz, maximizando el rendimiento.
      </p>
    </div>
    <div class="card">
      <h2>Dato Curioso</h2>
      <p>
        El tomate necesita entre un 60% y 80% de humedad en el suelo para desarrollarse óptimamente. En condiciones de humedad adecuada, puede triplicar su producción comparado con cultivos sin monitoreo.
      </p>
    </div>
  </div>

  <section class="graficos">
    <h2>Visualización en Tiempo Real desde Power BI 📊</h2>
    <div class="iframe-container">
      <iframe
        title="proyecto1"
        src="https://app.powerbi.com/reportEmbed?reportId=f600de6c-dcfb-4c79-ad87-4872a2d40fd7&autoAuth=true&ctid=5097e559-4258-4366-b031-df8fdc05d5c8"
        allowFullScreen="true">
      </iframe>
    </div>
  </section>

  <section class="chat">
    <h2>¿Preguntas? Nuestro bot las puede resolver 🤖</h2>

    <div class="chatbox" id="chatbox"></div>

    <div class="input-area">
      <input type="text" id="mensaje" placeholder="Escribe tu pregunta..." onkeydown="if(event.key === 'Enter') enviar()" />
      <button onclick="enviar()">Enviar</button>
    </div>
  </section>

  <script>
    function agregarMensaje(texto, clase) {
      const msg = document.createElement("div");
      msg.className = "mensaje " + clase;
      msg.innerText = texto;
      document.getElementById("chatbox").appendChild(msg);
      document.getElementById("chatbox").scrollTop = document.getElementById("chatbox").scrollHeight;
    }

    async function enviar() {
      const entrada = document.getElementById("mensaje");
      const texto = entrada.value.trim();
      if (!texto) return;

      agregarMensaje(texto, "usuario");
      entrada.value = "";

      agregarMensaje("⏳ Pensando...", "asistente");
      const esperando = document.querySelector(".asistente:last-child");

      try {
        const res = await fetch("/preguntar", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ mensaje: texto })
        });

        const data = await res.json();
        esperando.remove();
        agregarMensaje(data.respuesta, "asistente");
      } catch (error) {
        esperando.remove();
        agregarMensaje("❌ Error al procesar la respuesta.", "asistente");
      }
    }
  </script>
</body>
</html>
