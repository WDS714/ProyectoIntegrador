<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Sensor de Humedad para Invernaderos de Tomate ğŸ…</title>
  <link rel="stylesheet" href="/style.css">


</head>
<body>
  <header>
    <h1>Sensor de Humedad para Invernaderos de Tomate ğŸ…</h1>
  </header>

  <div class="info-section">
    <div class="card">
      <h2>Â¿Por quÃ© monitorear la humedad del suelo?</h2>
      <p>
        Monitorear la humedad del suelo es esencial para evitar el estrÃ©s hÃ­drico en los cultivos de tomate. Un suelo muy seco puede afectar negativamente el crecimiento, mientras que un exceso de agua favorece enfermedades fÃºngicas.
      </p>
    </div>
    <div class="card">
      <h2>Tomates en Invernaderos Colombianos</h2>
      <p>
        En Colombia, departamentos como BoyacÃ¡, Cundinamarca y Antioquia lideran la producciÃ³n de tomate en invernadero. Este mÃ©todo permite controlar mejor variables como la humedad, la temperatura y la luz, maximizando el rendimiento.
      </p>
    </div>
    <div class="card">
      <h2>Dato Curioso</h2>
      <p>
        El tomate necesita entre un 60% y 80% de humedad en el suelo para desarrollarse Ã³ptimamente. En condiciones de humedad adecuada, puede triplicar su producciÃ³n comparado con cultivos sin monitoreo.
      </p>
    </div>
  </div>

  <section class="graficos">
    <h2>VisualizaciÃ³n en Tiempo Real desde Power BI ğŸ“Š</h2>
    <div class="iframe-container">
      <iframe
        title="proyecto1"
        src="https://app.powerbi.com/reportEmbed?reportId=f600de6c-dcfb-4c79-ad87-4872a2d40fd7&autoAuth=true&ctid=5097e559-4258-4366-b031-df8fdc05d5c8"
        allowFullScreen="true">
      </iframe>
    </div>
  </section>

  <section class="chat">
    <h2>Â¿Preguntas? Nuestro bot las puede resolver ğŸ¤–</h2>

    <div class="chatbox" id="chatbox"></div>

    <div class="input-area">
      <input type="text" id="mensaje" placeholder="Escribe tu pregunta..." onkeydown="if(event.key === 'Enter') enviar()" />
      <button onclick="enviar()">Enviar</button>
    </div>
  </section>

  <script>
    function agregarMensaje(texto, clase) {
      const msg = document.createElement("div");
      msg.className = "mensaje " + clase;
      msg.innerText = texto;
      document.getElementById("chatbox").appendChild(msg);
      document.getElementById("chatbox").scrollTop = document.getElementById("chatbox").scrollHeight;
    }

    async function enviar() {
      const entrada = document.getElementById("mensaje");
      const texto = entrada.value.trim();
      if (!texto) return;

      agregarMensaje(texto, "usuario");
      entrada.value = "";

      agregarMensaje("â³ Pensando...", "asistente");
      const esperando = document.querySelector(".asistente:last-child");

      try {
        const res = await fetch("/preguntar", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ mensaje: texto })
        });

        const data = await res.json();
        esperando.remove();
        agregarMensaje(data.respuesta, "asistente");
      } catch (error) {
        esperando.remove();
        agregarMensaje("âŒ Error al procesar la respuesta.", "asistente");
      }
    }
  </script>
</body>
</html>
